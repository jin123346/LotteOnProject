<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/adminLayout.html}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Banner Page</title>
    <link rel="stylesheet" th:href="@{/css/admin/adminVersion.css}">
    <link rel="stylesheet" th:href="@{/css/admin/adminVersionModal.css}">
</head>
<body>
<th:block layout:fragment="content">
            <div id="admin_service">    
                <section>
                    <th:block th:replace="~{content/admin/admin_gate}"></th:block>

                    <section id="admin_navi">
                            <p>환경설정</p>
                            <p>
                                <a href="#">HOME</a>
                                <span>></span>
                                <a href="#">환경설정</a>
                                <span>></span>
                                <a href="#">버전이력</a>
                            </p>
                    </section>
                    <article id="admin_Version">
                        <div class="top1">버전 목록</div>
                        <div><span class="top2">사이트 버전 목록입니다.</span></div>
                        <table class="admin_Version_table">
                            <colgroup>
                                <col style="width: 10%">
                                <col style="width: 15%">
                                <col style="width: 20%">
                                <col style="width: 15%">
                                <col style="width: 25%">
                                <col style="width: 15%">
                            </colgroup>
                            <tr>
                                <th><input type="checkbox"></th>
                                <th>번호</th>
                                <th>버전</th>
                                <th>작성자</th>
                                <th>등록일시</th>
                                <th>변경내역</th>
                            </tr>
                            <tr>
                                <td><input type="checkbox"></td>
                                <td>1</td>
                                <td>0.0.01snapchat</td>
                                <td>wlgus59**</td>
                                <td>2020.10.13. 17:12:00</td>
                                <td><a href="#" class="openModalBtn2">[확인]</a></td>
                            </tr>
                            <tr>
                                <td><input type="checkbox"></td>
                                <td>1</td>
                                <td>0.0.01snapchat</td>
                                <td>wlgus59**</td>
                                <td>2020.10.13. 17:12:00</td>
                                <td><a href="#" class="openModalBtn2">[확인]</a></td>
                            </tr>
                            <tr>
                                <td><input type="checkbox"></td>
                                <td>1</td>
                                <td>0.0.01snapchat</td>
                                <td>wlgus59**</td>
                                <td>2020.10.13. 17:12:00</td>
                                <td><a href="#" class="openModalBtn2">[확인]</a></td>
                            </tr>
                            <tr>
                                <td><input type="checkbox"></td>
                                <td>1</td>
                                <td>0.0.01snapchat</td>
                                <td>wlgus59**</td>
                                <td>2020.10.13. 17:12:00</td>
                                <td><a href="#" class="openModalBtn2">[확인]</a></td>
                            </tr>
                            <tr>
                                <td><input type="checkbox"></td>
                                <td>1</td>
                                <td>0.0.01snapchat</td>
                                <td>wlgus59**</td>
                                <td>2020.10.13. 17:12:00</td>
                                <td><a href="#" class="openModalBtn2">[확인]</a></td>
                            </tr>
                        </table>
                        <div class="btn">
                            <button>선택삭제</button>
                            <button id="openModalBtn">등록</button>
                        </div>
                    </article>
                </section>



<!--  modal -->
        <div id="orderModal" class="modal">
            <div class="modal-content">
                <div class="header">
                    <span class="close" style="cursor:pointer; float: right;">&times;</span>
                    <h3>버전확인</h3>
                </div>
                <form id="versionForm">
                <table>
                    <colgroup>
                        <col style="width: 15%;">
                        <col style="width: 50%;">
                    </colgroup>
                    <tr>
                        <td>버전</td>
                        <td>
                            <input type="text" name="ver_name" placeholder="버전입력하기" >
                        </td>
                    </tr>
                    <tr>
                        <td style="height: 300px;">변경내역</td>
                        <td>
                            <input type="text" name="ver_content" placeholder="변경내역작성하기"  style="height: 300px;">
                        </td>
                    </tr>

                </table>
                <div>
                    <button type="submit">등록하기</button>
                </div>
                </form>
            </div>
        </div>

        <div class="modal orderModal">
            <div class="modal-content">
                <div class="header">
                    <span class="close2" style="cursor:pointer; float: right;">&times;</span>
                    <h3>버전확인</h3>
                </div>
                <table>
                    <colgroup>
                        <col style="width: 15%;">
                        <col style="width: 50%;">
                    </colgroup>
                    <tr>
                        <td>버전</td>
                        <td>
                            <span>0.0.1-SNAPSHOT</span>
                        </td>
                    </tr>
                    <tr>
                        <td style="height: 300px;">변경내역</td>
                        <td>
                            <span style="line-height: 1.8;">- 프로젝트 생성 및 전체 구조 설계</span><br>
                            <span style="line-height: 1.8;">- 회원가입 아이디 중복체크 완료</span><br>
                            <span style="line-height: 1.8;">- 관리자 상품 등록 완료</span><br>
                            <span style="line-height: 1.8;">- 쇼핑몰 메인 및 개별 페이지 링크 작업</span><br>
                            <span style="line-height: 1.8;">- 개발을 위한 제반 사항 처리</span><br>

                        </td>
                    </tr>
                </table>
                <div>
                    <button type="submit" class="closeButton">닫기</button>
                </div>
            </div>
        </div>
                <script>
                    document.getElementById('versionForm').addEventListener('submit', function(event) {
                        event.preventDefault(); // 기본 폼 제출 방지

                        // 폼 데이터 수집
                        const formData = {
                            ver_name: document.querySelector('input[name="ver_name"]').value,
                            ver_content: document.querySelector('input[name="ver_content"]').value
                        };

                        // fetch 요청
                        fetch("/admin/config/version", {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                            },
                            body: JSON.stringify(formData)
                        })
                            .then(response => {
                                // 응답 상태 코드 체크
                                if (!response.ok) {
                                    return response.text().then(text => {
                                        throw new Error(text || '등록 실패'); // 텍스트로 응답받기
                                    });
                                }
                                return response.text(); // 빈 응답이 올 수 있으므로 JSON이 아닌 텍스트로 받기
                            })
                            .then(data => {
                                if (data) {
                                    const jsonData = JSON.parse(data); // JSON 파싱
                                    alert(jsonData.message); // 메시지 출력
                                } else {
                                    alert('버전이 등록되었습니다.'); // 빈 응답에 대한 처리
                                }
                                document.getElementById('orderModal').style.display = 'none';
                            })
                            .catch(error => {
                                alert('등록 실패: ' + error.message);
                            });
                    });
                </script>
                <script th:src="@{/js/adminVersionModal.js}"></script>


</th:block>




